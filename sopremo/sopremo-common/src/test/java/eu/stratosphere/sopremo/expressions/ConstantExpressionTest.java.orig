package eu.stratosphere.sopremo.expressions;

import junit.framework.Assert;
import nl.jqno.equalsverifier.EqualsVerifier;
import nl.jqno.equalsverifier.Warning;

<<<<<<< HEAD
import org.codehaus.jackson.JsonNode;
import org.codehaus.jackson.node.DoubleNode;
import org.codehaus.jackson.node.IntNode;
=======
>>>>>>> 082f89a35aa389ea6271765d2b5db6f13914f3ec
import org.junit.Test;

import eu.stratosphere.sopremo.jsondatamodel.DoubleNode;
import eu.stratosphere.sopremo.jsondatamodel.IntNode;
import eu.stratosphere.sopremo.jsondatamodel.JsonNode;

public class ConstantExpressionTest extends EvaluableExpressionTest<ConstantExpression> {

	@Override
	protected ConstantExpression createDefaultInstance(final int index) {
		return new ConstantExpression(IntNode.valueOf(index));
	}

	@Override
	protected void initVerifier(final EqualsVerifier<ConstantExpression> equalVerifier) {
		super.initVerifier(equalVerifier);
		equalVerifier.withPrefabValues(JsonNode.class, IntNode.valueOf(23), IntNode.valueOf(42));
		equalVerifier.suppress(Warning.TRANSIENT_FIELDS);
	}

	@Test
	public void shouldCastNumericNodeCorrectly() {
		final int result = new ConstantExpression(IntNode.valueOf(42)).asInt();

		Assert.assertEquals(42, result);
	}

	@Test
	public void should() {
		final int result = new ConstantExpression(DoubleNode.valueOf(42.0)).asInt();

		Assert.assertEquals(42, result);
	}

	@Test
	public void shouldReturnCorrectStringRepresentation() {
		final String result = new ConstantExpression(IntNode.valueOf(42)).asString();

		Assert.assertEquals("42", result);
	}
}
