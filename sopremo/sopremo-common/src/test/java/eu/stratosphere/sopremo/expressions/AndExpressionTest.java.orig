package eu.stratosphere.sopremo.expressions;

import java.util.Arrays;

import junit.framework.Assert;
<<<<<<< HEAD

import org.codehaus.jackson.JsonNode;
import org.codehaus.jackson.node.BooleanNode;
import org.codehaus.jackson.node.IntNode;
import org.junit.Test;
=======

import org.junit.Test;

import eu.stratosphere.sopremo.jsondatamodel.BooleanNode;
import eu.stratosphere.sopremo.jsondatamodel.IntNode;
import eu.stratosphere.sopremo.jsondatamodel.JsonNode;
>>>>>>> 082f89a35aa389ea6271765d2b5db6f13914f3ec

public class AndExpressionTest extends BooleanExpressionTest<AndExpression> {

	@Override
<<<<<<< HEAD
	protected AndExpression createDefaultInstance(int index) {
		EvaluationExpression[] params = new EvaluationExpression[index + 1];
		Arrays.fill(params, TRUE);
		return new AndExpression(params);
=======
	protected AndExpression createDefaultInstance(final int index) {

		switch (index) {
		case 0: {
			return new AndExpression(this.TRUE);
		}
		case 1: {
			return new AndExpression(this.TRUE, this.TRUE);
		}
		case 2: {
			return new AndExpression(this.TRUE, this.TRUE, this.TRUE);
		}
		}

		return super.createDefaultInstance(index);
>>>>>>> 082f89a35aa389ea6271765d2b5db6f13914f3ec
	}

	@Test
	public void shouldBeTrueIfAllExprAreTrue() {
		final JsonNode result = new AndExpression(this.TRUE, this.TRUE, this.TRUE).evaluate(IntNode.valueOf(42),
			this.context);

		Assert.assertEquals(BooleanNode.TRUE, result);
	}

	@Test
	public void shouldBeFalseIfOneExprIsFalse() {
		final JsonNode result = new AndExpression(this.TRUE, this.FALSE, this.TRUE).evaluate(IntNode.valueOf(42),
			this.context);

		Assert.assertEquals(BooleanNode.FALSE, result);
	}

	@SuppressWarnings("unused")
	@Test(expected = IllegalArgumentException.class)
	public void shouldThrowExceptionIfExpressionsAreEmpty() {
		new AndExpression();
	}
}
